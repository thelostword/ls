(function(a,f){typeof exports=="object"&&typeof module<"u"?f(exports):typeof define=="function"&&define.amd?define(["exports"],f):(a=typeof globalThis<"u"?globalThis:a||self,f(a.$ls={}))})(this,function(a){"use strict";const f=r=>{if(typeof r!="string"||!r)throw new TypeError("Input must be a string and cannot be empty!");const n=Math.floor(Math.random()*256),t=r.length,e=new Uint16Array(t+1);for(let o=0;o<=t;o++)e[o]=r.charCodeAt(o)^n;e[t]=n;const c=new Uint8Array(e.buffer),l=String.fromCharCode(...c);return btoa(l)},i=r=>{if(typeof r!="string"||!r)throw new TypeError("Input must be a string and cannot be empty!");const n=atob(r),t=new Uint8Array(n.length);for(let o=0;o<t.length;o++)t[o]=n.charCodeAt(o);const e=new Uint16Array(t.buffer),c=e.length-1,l=new Array(c);for(let o=0;o<c;o++)l[o]=String.fromCharCode(e[o]^e[c]);return l.join("")};let s=localStorage.getItem("__LS_PREFIX__")||"MOE_";const d=()=>void localStorage.clear(),u=r=>void localStorage.removeItem(`${s}${r}`),g=(r,n=!1)=>{const t=localStorage.getItem(`${s}${r}`);if(!t)return;const e=JSON.parse(t);if(e.expires&&e.expires<=Date.now()){u(`${s}${r}`);return}return e.encrypt&&(e.value===""||e.value===null||e.value===void 0||typeof e.value=="string"&&(e.value=i(e.value)),e.__isJson&&(e.value=JSON.parse(i(e.value)))),n?e:e.value},y=(r,n,t)=>{if(!r)throw new Error("缺少必要参数!");let e;const l={value:(()=>{if(n===""||n===null||n===void 0)return n;if(t!=null&&t.encrypt){if(typeof n=="string")return f(n);if(typeof n=="object")return e=!0,f(JSON.stringify(n))}return n})(),expires:t!=null&&t.expires?Date.now()+t.expires:0,encrypt:t==null?void 0:t.encrypt,__isJson:e};localStorage.setItem(`${s}${r}`,JSON.stringify(l))},h=r=>{if(r===s)return;const n=[];for(let t=0;t<localStorage.length;t++){const e=localStorage.key(t),c=localStorage.getItem(e);if(e.startsWith(s)){const l=e.replace(new RegExp(`^${s}`),r);localStorage.setItem(l,c),n.push(e)}}s=r,localStorage.setItem("__LS_PREFIX__",r),n.forEach(t=>{localStorage.removeItem(t)})};a.clear=d,a.decrypt=i,a.encrypt=f,a.get=g,a.remove=u,a.set=y,a.setPrefix=h,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
